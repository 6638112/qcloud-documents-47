## 概述
数据质量服务是对项目下的数据进行质量监控管理的工具，可以从数据准确性、及时性、完整性、唯一性和一致性五个维度进行表级、字段级的数据分析。支持40+常用规则模板的快速配置和灵活的自定义 SQL，您可以离线手动执行质量检测扫描，也可以关联开发任务实现周期性的质量监控并生成质量分析报表，提供日常数据生产链路的质量运维能力。
## 质量概览
默认首页是质量概览页面，展示周期内质量检测结果的各项数据指标，便于用户洞察数据质量的周期性变化并快速定位问题数据表和字段。
![](https://qcloudimg.tencent-cloud.cn/raw/212ae9c868b4673f697f7a9e0bc522f5.png)
<table>
<thead>
<tr>
<th >信息</th>
<th >详情</th>
</tr>
</thead>
<tbody>
<tr>
<td><nobr>数据检测概况</td>
<td>周期内扫描过的表（表去重）和字段数（字段去重）</td>
</tr><tr>
<td>规则运行情况</td>
<td>周期内规则运行数量及其环比变化比例</td>
</tr><tr>
<td>规则触发维度分布</td><td>周期内所有检测出现异常的任务中，各维度情况的占比（各类异常规则数/异常规则总数）</td>
</tr><tr>
<td>告警趋势</td><td>周期内发生告警的次数趋势图（按天）</td>
</tr><tr>
<td>表告警排行</td><td>周期内发生告警次数最多的表排名前 Top30</td>
</tr><tr>
<td>阻塞趋势</td><td>周期内发生阻塞的次数趋势图（按天）</td>
</tr><tr>
<td>表阻塞排行</td><td>周期内发生阻塞次数最多的表排名前 Top30</td>
</tr>
</tbody>
</table>

## 规则模板
系统模板管理页面，支持规则模板的查询和信息展示。
![](https://qcloudimg.tencent-cloud.cn/raw/7fac0a5873a00c40370a6a7f40352f9c.png)

| 信息 | 详情 |
|---------|---------|
| 模板类型 | 2种模板：表级、字段级，支持基于类型的模板筛选 | 
| 模板名称	| 模板名称| 
| 模板描述	| 对该模板检测内容的详细描述| 
| 维度	| 6种维度：准确性、唯一性、完整性、一致性、及时性、有效性，支持基于维度的模板筛选| 
| 适用对象	| 该模板适用的表类型，目前支持 Hive 类型| 
| 引用数	| 当前模板被引用的规则数量| 

## 数据监控
数据监控功能默认进入数据表列表展示页面，从数据对象视角出发，提供以表为维度的监控配置入口和信息展示。支持基于数据来源、针对当前帐号进行“我订阅”（订阅配置的告警接受人包含当前帐号的）的信息过滤，以及以表名、表负责人进行搜索。目前质量监控的对象仅针对系统源（自动采集）中的 EMR-Hive。
![](https://qcloudimg.tencent-cloud.cn/raw/34afafbc9b09bc271fa65e41da73a152.png)

| 信息 | 详情 | 
|---------|---------|
| 表名 | 数据表 | 
| 表负责人	| 表负责人| 
| 监控方式	| 3种状态：关联生产调度、离线周期检测、未配置，支持基于监控方式进行表筛选| 
| 关联作业	| 关联任务的名称及 ID| 
| 监控更新时间	| 执行监控任务的最新时间| 

- 我订阅的
当用户勾选我订阅的条件后，列表中仅展示当前用户为订阅信息接收人的表信息。
- 配置监控规则
单击对应表在列表操作列的“配置监控任务”，即可进入质量规则的配置页面，针对选择的数据表进行监控任务的配置。
![](https://qcloudimg.tencent-cloud.cn/raw/f8dcb8f208b0c6939b6f79836066aafc.png)

| 信息 | 详情 | 
|---------|---------|
| 文本1 | 文本2 | 
| 规则名称	| 规则名称| 
| 规则类型	| 3种类型：系统模板、自定义 SQL、自定义模板，支持按类型筛选规则| 
| 数据对象	| 表级规则（table）/表字段信息（字段类型） ，支持按数据对象筛选规则| 
| 规则模板	| 系统内置模板40+，详见模板说明。对于自定义 SQL 则输入一条 SQL 语句| 
| 配置人	| 为表配置该条规则的用户名| 

1. 创建/编辑规则
	- 创建规则
单击左上角**新增**，即可弹出创建规则弹窗。
![](https://qcloudimg.tencent-cloud.cn/raw/045f04d591a9eccf923c262868a3580f.png)
![](https://qcloudimg.tencent-cloud.cn/raw/3b3654337ad5d1d8c2e8c974750bf919.png)
	- 编辑规则
选择需要进行编辑的规则，单击**编辑**，即可调整现有规则的配置信息。
![](https://qcloudimg.tencent-cloud.cn/raw/771f1a2c6b75ceafe8377dee02edd180.png)
![](https://qcloudimg.tencent-cloud.cn/raw/a0c9980f4797370322ed8eea9cf2befd.png)
<table>
<thead>
<tr>
<th >信息</th>
<th >详情</th>
</tr>
</thead>
<tbody>
<tr>
<td>规则名称</td>
<td>用户自定义的规则名称（当前页面唯一）</td>
</tr><tr>
<td>规则描述</td>
<td>对当前规则的描述</td>
</tr>
<tr>
<td>规则类型</td>
<td>系统模板/自定义 SQL</td>
</tr><tr>
<td>数据对象</td>
<td>表（table）/该表字段名（字段类型），选择自定义 SQL 后对象只能是表</td>
</tr><tr>
<td>选择模板</td><td>	模板名称参考 （一期仅实现资料中没有置灰的部分），字段类型联动模板选项，数值类型的模板仅在数据对象是数值时显示</td>
</tr><tr>
<td>触发条件 </td><td>	固定值比较/波动率</td>
</tr><tr>
<td>触发等级	</td><td>	高/中/低（处理逻辑参考说明描述）</td>
</tr><tr>
<td>检测范围	</td><td>	全表或者条件扫描（对于自定义 SQL，在语句里面添加即可）</td>
</tr><tr>
<td>定义维度	</td><td>	下拉选择范围包括准确性、及时性、完整性、一致性、唯一性</td>
</tr>
</tbody>
</table>

	- 规则模板说明：
![](https://qcloudimg.tencent-cloud.cn/raw/510a7bf1f0300a41805821ffe96c9648.png)
		- 绿色内容为系统内置规则模板的名称，一共40+，针对**表级**的模板有7个，剩下的均为针对某个**字段**的模板。
		- 系统内置规则模板主要分为与固定值比较和波动率比较两种校验方法，不同的校验方法对应的“比较方式”、可设置的“阈值”个数、以及“预警等级”含义都有所不同，具体参见下图。
		- 红框内的模板是针对数值类型的字段，只有当选择的字段类型是数值类型时才会出现在选择框中。
		- 对于波动率的“比较方式”说明如下：
![](https://qcloudimg.tencent-cloud.cn/raw/5fd4e674eea1a6a135f8cad6538878ef.png)

2. 执行策略
![](https://qcloudimg.tencent-cloud.cn/raw/720a9efd4d55dada63d03bc27ea37433.png)
<table>
<thead>
<tr>
<th >信息</th>
<th >详情</th>
</tr>
</thead>
<tbody>
<tr>
<td>执行方式</td>
<td>3种执行方式：无、关联生产调度（关联生产任务，在任务完成后执行质量检测）、离线周期检测（根据配置周期执行定期质量检测）</td>
</tr><tr>
<td>计算资源</td>
<td>选择已经配置完毕的计算资源</td>
</tr><tr>
<td>执行资源</td><td>选择已经配置完毕的调度资源组</td>
</tr><tr>
<td>调度周期</td><td>任务调度的执行周期单位，支持分钟、小时、天、周、月、年和一次性</td>
</tr><tr>
<td>生效日期</td><td>任务调度执行的有效时间范围，过期后任务停止调度执行</td>
</tr><tr>
<td>调度计划</td><td>用户可自行设定该任务每次执行间隔的时长以及任务开始执行的具体时间。如下图周期间隔为10分钟，则调度任务将在2022年3月27日到2022年4月27日中每天的00:00到23:59分之间每隔10分钟运行一次</td>
</tr><tr>
<td><nobr>Cron 表达式</td><td>根据用户所选择的调度计划，系统自动生成对应的 Cron 表达式</td>
</tr>
</tbody>
</table>
生产调度的方式：选择执行的资源和关联的任务；任务支持名称和 ID 的搜索选择，生成的任务信息可点击跳转到数据开发任务运维的页面
离线周期检测：周期的配置灵活度依赖数据开发任务调度的周期配置，两边能力和交互保持一致即可（用户可以在不捆绑任务情况下和任务执行周期保持同步从而实现跟踪生产的效果）。

3. 订阅配置
选择订阅方式（邮件/短信）和告警信息接收人（支持多选）。
![](https://qcloudimg.tencent-cloud.cn/raw/04467ef5987b4518d3a740d0d5aa6209.png)
4. 试运行
在配置完毕计算资源、执行资源、验证规则（验证规则默认全选，根据规则对应的检测范围提供参数输入框）后，单击**运行**按钮即可执行试运行。单击后，生成新的页面跳转到任务运维页面，系统自动筛选出当前任务的执行信息。
![](https://qcloudimg.tencent-cloud.cn/raw/339d85766f58e903e35828ada64a6784.png)
5. 查看规则操作日志
单击规则列表中对应规则右侧的**日志**即可进入操作日志，记录规则配置的制作人、操作时间、操作内容信息。
![](https://qcloudimg.tencent-cloud.cn/raw/6a155276c86757153d2ebb136ce4010d.png)

## 运维管理
运维管理功能是质量检测任务的运维，支持按照数据来源、执行日期、是否订阅查找质量检测任务，并查看任务运行相关情况。查询列表中根据表名+执行时间+执行方式唯一确定一条检测任务，相同表检测多次会展示最近一次检测状态。
![](https://qcloudimg.tencent-cloud.cn/raw/8355c15be31c36d368ebf884f16418a5.png)
<table>
<thead>
<tr>
<th >信息</th>
<th >详情</th>
</tr>
</thead>
<tbody>
</tr><tr>
<td>表名（执行 ID）</td><td>表名（触发该次质量检测的数据开发任务 ID）</td>
</tr><tr>
<td>表负责人	</td><td>表负责人</td>
<tr></tr>
<td>执行时间	</td><td>质量检测触发执行的时间</td>
</tr><tr>
<td>执行方式	</td><td>周期检测、调度触发</td>
</tr><tr>
<td>检测状态	</td><td>检测中、异常（规则组中任一条被触发就算检测任务异常）、正常</td>
</tr><tr>
<td>异常规则	</td><td>异常规则个数/总规则数</td>
</tr>
</tbody>
</table>

1. 选择并单击任务可查看检测任务详情（二级列表）。
![](https://qcloudimg.tencent-cloud.cn/raw/34e17ec4f9e266c5297ca82ef9ff6616.png)
显示当前质量任务基本信息。
<table>
<thead>
<tr>
<th >信息</th>
<th >详情</th>
</tr>
</thead>
<tbody>
</tr><tr>
<td>规则名称</td><td>规则名称</td>
</tr><tr>
<td>规则类型	</td><td>系统内置/自定义 SQL</td>
</tr><tr>
<td>数据对象	</td><td>表级规则（table）/表字段信息（字段类型）</td>
</tr><tr>
<td>检测范围	</td><td>实际检测范围</td>
</tr><tr>
<td>规则详情	</td><td>配置的规则信息组合，可查看具体的配置内容</td>
</tr><tr>
<td>预警等级	</td><td>配置的预警等级，不同模板的每个等级对应的异常反馈程度不同（详见规则模板说明）</td>
</tr><tr>
<td>检测结果	</td><td>3种状态：检测通过、触发规则、检测失败（其他原因导致检测任务执行失败）</td>
</tr><tr>
<td>触发结果	</td><td>3种状态：无、发送告警、发送告警且阻断下游（订阅的告警接受人会在配置的通道收到告警信息)</td>
</tr><tr>
<td>计算结果对比	</td><td>检测的结果数据/配置的阈值，发生异常的结果数据会有不同颜色高亮显示，多条检测结果以逗号进行分隔</td>
</tr>
</tbody>
</table>
2. 单击任务列表操作列的**日志**，可查看检测任务的日志信息。
3. 单击任务列表操作列的**查看规则**，跳转到数据监控页面。

